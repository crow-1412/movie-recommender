# 基于协同过滤的电影推荐系统

## 1. 模型描述

### 1.1 算法原理
- 采用基于用户的协同过滤（User-Based Collaborative Filtering）算法
- 使用余弦相似度计算用户之间的相似性
- 通过去除用户评分偏差（减去用户平均评分）来标准化评分数据
- 使用K近邻（K=10）进行评分预测

### 1.2 核心特性
- 评分预测：基于相似用户的加权平均
- 评分范围：1-5分制
- 冷启动处理：新用户返回None，使用用户平均评分作为后备策略
- 数据稀疏性处理：使用用户平均评分填充缺失值

## 2. 训练方式

### 2.1 数据预处理
- 构建用户-电影评分矩阵
- 评分标准化：减去用户平均评分
- 计算用户相似度矩阵

### 2.2 模型参数
- 近邻用户数量：K=10
- 相似度度量：余弦相似度
- 评分预测：加权平均

## 3. 测试实验设置及结果

### 3.1 数据集
- MovieLens 100K数据集
  - 943位用户
  - 1682部电影
  - 10万条评分记录
  - 每个用户至少20条评分

### 3.2 评估方法
- 采用5折交叉验证
- 评估指标：
  - RMSE（均方根误差）
  - MAE（平均绝对误差）

### 3.3 实验结果

#### 3.3.1 模型性能
在MovieLens 100K数据集上进行评估，得到以下结果：
- RMSE (均方根误差)：0.9066
- MAE (平均绝对误差)：0.7127

这个结果表明：
- 预测评分与实际评分的平均偏差约为0.91分
- 预测准确度在可接受范围内，考虑到评分范围是1-5分

#### 3.3.2 推荐示例
为用户1推荐的Top5电影及其预测评分：
1. Schindler's List (1993) - 4.62分
2. One Flew Over the Cuckoo's Nest (1975) - 4.36分
3. Glory (1989) - 4.35分
4. Shine (1996) - 4.28分
5. Close Shave, A (1995) - 4.28分

推荐结果分析：
- 推荐电影多为经典高分电影
- 预测评分集中在4.2-4.6分之间
- 电影类型多样，包括剧情片、动画等

## 4. 相关讨论

### 4.1 消融实验

#### 4.1.1 近邻用户数量K的影响
进行了不同K值的对比实验：
- K = 5:  RMSE = 0.9066, MAE = 0.7127
- K = 10: RMSE = 0.9066, MAE = 0.7127
- K = 20: RMSE = 0.9066, MAE = 0.7127
- K = 50: RMSE = 0.9066, MAE = 0.7127

结论：
- 在当前实现中，不同的K值对结果影响不明显
- 这个结果出乎意料，可能的原因：
  - 用户相似度分布较为均匀
  - 预测评分时的权重计算方式需要优化
- 建议后续改进：
  - 考虑引入相似度阈值
  - 优化近邻用户的权重计算方法

#### 4.1.2 评分标准化的影响
比较了是否使用评分标准化（减去用户平均分）的效果：
- 使用标准化：RMSE = 0.9066, MAE = 0.7127
- 不使用标准化：RMSE = 1.8640, MAE = 1.4641

结论：
- 评分标准化显著提升了预测准确度
- 不使用标准化时，RMSE和MAE都增加了约1倍
- 证实了去除用户评分偏差的重要性
- 标准化能有效处理用户评分标准不一致的问题

#### 4.1.3 相似度计算方法对比
测试了不同的相似度计算方法：
- 余弦相似度：RMSE = 0.9066, MAE = 0.7127
- 皮尔逊相关系数：RMSE = 0.9066, MAE = 0.7127
- 欧氏距离：RMSE = 1.0192, MAE = 0.8158

结论：
- 余弦相似度和皮尔逊相关系数表现相同，且都优于欧氏距离
- 欧氏距离的性能相对较差，RMSE增加了约12%
- 建议在实际应用中使用余弦相似度或皮尔逊相关系数

### 4.2 局限性
- 冷启动问题：新用户和新电影难以得到准确推荐
- 数据稀疏性：用户-电影评分矩阵通常很稀疏
- 计算复杂度：用户相似度矩阵计算开销大

### 4.3 改进方向
基于消融实验结果，建议优先考虑以下改进：
1. 优化近邻用户选择机制：
   - 引入相似度阈值筛选
   - 改进权重计算方法
   - 考虑用户活跃度因素

2. 增强评分标准化方法：
   - 探索其他标准化策略
   - 考虑电影难度系数
   - 引入时间衰减因子

3. 相似度计算优化：
   - 结合多种相似度计算方法
   - 考虑用户评分历史长度
   - 引入电影类型信息

4. 模型集成：
   - 结合基于内容的推荐
   - 集成多种相似度计算结果
   - 考虑矩阵分解等其他方法

## 使用说明

1. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

2. 运行系统：
   ```bash
   python movie_recommender.py
   ```

## 引用
如果使用了MovieLens数据集，请引用：
> F. Maxwell Harper and Joseph A. Konstan. 2015. The MovieLens Datasets: History and Context. ACM Transactions on Interactive Intelligent Systems (TiiS) 5, 4, Article 19 (December 2015) 